name: Scrape files

on:
  workflow_dispatch:
  
  schedule:
    - cron: '10 12 */7 * *'

jobs:
  scrape-files:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
  
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
            node-version: '20.x'

      - name: Install dependencies
        uses: bahmutov/npm-install@v1
        with:
            useLockFile: false
            working-directory: scrape-files

      - name: Download files.txt
        env:
          DOWNLOAD_FILES: ${{ vars.DOWNLOAD_FILES }}
        working-directory: scrape-files
        run: |
            node scrape.js